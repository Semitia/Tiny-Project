# 打卡机

## 基本流程

​	主要是模拟题目的要求，一步步进行。有一个贯彻始终的小时钟可以方便的记录时间。

## 主要的一些结构体

### clock

```c
typedef struct __clock_t{
	u16 CNT;
	u8 second;
	u8 minute;
	u8 hour;
	void (*p_update)(void);
}clock_t;
```

​	是基于TIM3写的一个模拟的程序自身的小钟表。每一秒自动更新一次时间，也可以调用**get_time( )**随时获取，只精确到0.0001s。

​	程序中是`clock_t p_clock`,没有使用指针。在加入**TIM3的定时器中断**后程序变得异常，没反应。但是我设置的中断间隔是**1s**，理论上不会因为频繁中断影响程序。调试后发现问题可能出在原来用的指针`clock_t *p_clock;`

​	debug发现会跳转到**HardFault_Handler（ ）**，一开始以为是堆栈溢出，但是其所需空间并不多，之前的四个**LED_t**指针都没问题,两者几乎是一样的格式。还是想再尝试一下。

### person

``` c
typedef struct __person_t{
	u8 *name;
	u8 *password;
	clock_t sign_up_time;
	record_t *own_record;
	
	struct __person_t *next;
}person_t;

```

​	储存人物信息。本来打算人物相关的数据和函数单独放在**person.h**和**person.c**里面的。但是编译总是提醒 *clock_* **未定义**，其他文件都使用正常。所以暂时先将其放在了**main.c**里面。



## 一些函数

### wait( )

​	延时函数，利用TIM3实现，理论上也是能精确到0.0001s，但是实际如何也不太好判断。

> 如果直接用**delay( )**的话，没有办法准确延时，有时长，大部分时候很短。猜测可能是定时器中断导致的

## 一些遗憾

​	非常抱歉，由于自己对任务时间没有准确的把握，这个任务只算完成了一大半。后续我会继续完善这份代码，包括之前费了不少时间却没有解决的问题，没有来得及加设的功能等等。